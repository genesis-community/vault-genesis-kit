- name: patch
  public: true
  plan:
  - do:
    - { get: version, trigger: false, params: {bump: patch} }
    - { put: version,                 params: {file: version/number} }
    on_success:
      put: notify
      params:
        topic:   (( concat meta.shout.topic "-$BUILD_JOB_NAME" ))
        message: minor version bump job 'patch' succeeded.
        ok:      yes
        link:    (( grab meta.shout.links.build ))
    on_failure:
      put: notify
      params:
        topic:   (( concat meta.shout.topic "-$BUILD_JOB_NAME" ))
        message: minor version bump job 'minor' failed (which is unusual).
        ok:      no
        link:    (( grab meta.shout.links.build ))

- name: minor
  public: true
  plan:
  - do:
    - { get: version, trigger: false, params: {bump: minor} }
    - { put: version,                 params: {file: version/number} }
    on_success:
      put: notify
      params:
        topic:   (( concat meta.shout.topic "-$BUILD_JOB_NAME" ))
        message: minor version bump job 'minor' succeeded.
        ok:      yes
        link:    (( grab meta.shout.links.build ))
    on_failure:
      put: notify
      params:
        topic:   (( concat meta.shout.topic "-$BUILD_JOB_NAME" ))
        message: minor version bump job 'minor' failed (which is unusual).
        ok:      no
        link:    (( grab meta.shout.links.build ))

- name: major
  public: true
  plan:
  - do:
    - { get: version, trigger: false, params: {bump: major} }
    - { put: version,                 params: {file: version/number} }
    on_success:
      put: notify
      params:
        topic:   (( concat meta.shout.topic "-$BUILD_JOB_NAME" ))
        message: major version bump job '$BUILD_JOB_NAME' succeeded.
        ok:      no
        link:    (( grab meta.shout.links.build ))
    on_failure:
      put: notify
      params:
        topic:   (( concat meta.shout.topic "-$BUILD_JOB_NAME" ))
        message: major version bump job '$BUILD_JOB_NAME' failed (which is unusual).
        ok:      no
        link:    (( grab meta.shout.links.build ))

